<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- SECURITY: 'unsafe-inline' is removed for scripts, making the site more secure. -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; connect-src 'self' https://corsproxy.io https://api.allorigins.win; img-src 'self' data:;">
  <title>Portfolio Backtester v8.1.0 (Refactored)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js" defer></script>
  <style>
    :root {
      --primary-color: #007aff; --primary-hover: #005ecb; --border-color: #dee2e6;
      --background-main: #f0f2f5; --background-card: #ffffff; --text-color: #212529;
      --text-light: #6c757d; --error-color: #d93025; --green: #34c759; --red: #ff3b30;
      --warn-bg: #fff3cd; --warn-border: #ffeeba; --warn-text: #856404;
      --critical-warn-bg: #f8d7da; --critical-warn-border: #f5c6cb; --critical-warn-text: #721c24;
    }
    html { scroll-behavior: smooth; font-size: 16px; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background-color: var(--background-main); color: var(--text-color); margin: 0; padding: 0 0 2.5rem 0;
      font-size: 1rem;
    }
    .app-container { max-width: 1200px; margin: 0 auto; padding: 0.625rem; }
    h1, h2, h3, h4 { color: var(--text-color); }
    h1 { font-size: 1.625rem; margin-bottom: 0.3rem; text-align: center; }
    h2 { font-size: 1.25rem; margin-top: 0.625rem; border-bottom: 1px solid var(--border-color); padding-bottom: 0.5rem; }
    h3 { font-size: 1.125rem; margin-top: 1.5rem; margin-bottom: -0.3rem; }
    h4 { font-size: 1rem; margin-top: 1.25rem; }
    .version { font-size: 0.875rem; color: var(--text-light); margin-top: 0; margin-bottom: 1.25rem; text-align: center; }
    .section-card {
      background: var(--background-card); border-radius: 10px; padding: 1.25rem;
      margin-bottom: 1.25rem; box-shadow: 0 2px 8px rgba(0,0,0,0.07);
    }
    .controls-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.125rem; }
    .control-group { display: flex; flex-direction: column; gap: 0.375rem; }
    .control-group label { font-weight: 600; font-size: 0.875rem; display: flex; align-items: center; gap: 0.375rem; }
    .control-group input, .control-group select {
      width: 100%; box-sizing: border-box; font-size: 0.9375rem; padding: 0.625rem;
      border-radius: 6px; border: 1px solid var(--border-color);
    }
    input:focus-visible, select:focus-visible, button:focus-visible, input[type="checkbox"]:focus-visible + label {
        outline: 2px solid var(--primary-color);
        outline-offset: 2px;
        box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.2);
    }
    .help-icon {
        display: inline-flex; align-items: center; justify-content: center;
        width: 1.125rem; height: 1.125rem; border-radius: 50%; background-color: #e9ecef;
        color: #6c757d; font-size: 0.6875rem; font-weight: bold;
        cursor: help; user-select: none; flex-shrink: 0;
    }
    #master-tooltip {
        visibility: hidden; opacity: 0; transition: opacity 0.2s, visibility 0.2s;
        position: fixed;
        width: 260px; background-color: #343a40; color: #fff;
        text-align: left; border-radius: 6px; padding: 0.625rem;
        z-index: 1000; pointer-events: none;
        font-size: 0.8125rem; font-weight: 400; line-height: 1.5;
    }
    #portfolios-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; }
    #portfolios-empty-state {
        text-align: center;
        padding: 2rem 1.25rem;
        background-color: #f8f9fa;
        border: 2px dashed var(--border-color);
        border-radius: 8px;
        color: var(--text-light);
        font-weight: 500;
    }
    .portfolio-card { border: 1px solid transparent; border-radius: 8px; padding: 1rem; background: #f8f9fa; }
    .portfolio-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem; }
    .portfolio-header input[type="text"] { font-size: 1.125rem; font-weight: bold; border: none; background: transparent; padding: 0.3rem; width: 70%; }
    .remove-portfolio-btn { background: #e9ecef; color: var(--text-light); border: none; border-radius: 6px; padding: 0.3rem 0.5rem; cursor: pointer; font-size: 0.75rem; font-weight: 600; }
    .ticker-input-row { display: flex; flex-wrap: nowrap; gap: 0.5rem; margin-bottom: 0.5rem; align-items: center; }
    .ticker-input-row input { text-transform: uppercase; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 6px; font-size: 0.875rem; }
    .remove-ticker-btn { background: var(--red); color: white; border: none; border-radius: 50%; width: 1.625rem; height: 1.625rem; cursor: pointer; font-size: 0.875rem; line-height: 1.625rem; text-align: center; }
    .add-btn { background: var(--primary-color); color: white; border: none; border-radius: 8px; padding: 0.625rem 1rem; cursor: pointer; font-weight: 500; }
    #add-portfolio-btn { margin-top: 1rem; }
    .add-ticker-btn { font-size: 0.875rem; padding: 0.5rem 0.75rem; }

    .run-button-container { display: flex; justify-content: center; align-items: center; gap: 1rem; margin: 1.5rem 0; }
    #run-backtest-btn, #run-projections-btn { font-size: 1rem; padding: 0.75rem 2rem; }
    #run-backtest-btn:disabled, #run-projections-btn:disabled { background-color: #a0c3ff; cursor: not-allowed; }
    .loader { display: none; width: 1.5rem; height: 1.5rem; border: 3px solid var(--primary-color); border-bottom-color: transparent; border-radius: 50%; animation: rotation 1s linear infinite; }
    @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .mini-loader { display: inline-block; vertical-align: middle; width: 0.875rem; height: 0.875rem; border: 2px solid var(--border-color); border-bottom-color: transparent; border-radius: 50%; animation: rotation 0.8s linear infinite; }
    #error-container { color: var(--error-color); text-align: center; font-weight: bold; margin: 1rem auto; max-width: 600px; }
    #info-container {
        display: none; padding: 0.75rem 1.125rem; margin: -0.625rem auto 1.25rem auto; max-width: 1160px;
        border-radius: 8px; text-align: left; font-size: 0.875rem;
        background-color: var(--warn-bg); border: 1px solid var(--warn-border); color: var(--warn-text);
    }
    #info-container ul { margin: 0; padding-left: 1.25rem; }
    #info-container li { margin-bottom: 0.3rem; }

    .table-container { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 0.625rem; margin-top: 1rem; }
    th, td { border: 1px solid var(--border-color); padding: 0.625rem 0.75rem; text-align: right; font-size: 0.875rem; white-space: nowrap; vertical-align: middle; }
    th { background: #e9ecef; font-weight: 600; text-align: center; }
    td:first-child, th:first-child { text-align: left; font-weight: bold; white-space: normal; }
    .positive { color: var(--green); } .negative { color: var(--red); }
    .hidden { display: none; }
    
    .results-header { display:flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); flex-wrap: wrap; gap: 1rem;}
    .toggle-switch { display:flex; align-items:center; gap:0.5rem; font-size: 0.875rem; font-weight: 600; }
    .toggle-switch label { font-weight: normal; }
    .toggle-switch input { height: 1.25em; width: 2.25em; appearance: none; background-color: #ccc; border-radius: 1.25em; position: relative; cursor: pointer; transition: background-color 0.2s; }
    .toggle-switch input::before { content: ''; position: absolute; height: 1em; width: 1em; background-color: white; border-radius: 50%; top: 0.125em; left: 0.125em; transition: transform 0.2s; }
    .toggle-switch input:checked { background-color: var(--primary-color); }
    .toggle-switch input:checked::before { transform: translateX(1em); }
    #results-area.basic-view .advanced-metric-card { display: none; }
    
    #results-area { position: relative; }
    .results-stale-overlay {
        position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        background-color: rgba(240, 242, 245, 0.85); backdrop-filter: blur(4px); -webkit-backdrop-filter: blur(4px);
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        text-align: center; font-size: 1.125rem; font-weight: 600; color: var(--text-color);
        border-radius: 10px; z-index: 100; padding: 1rem;
    }

    #projection-warning {
        padding: 0.75rem 1.125rem; margin: 0 auto 1.25rem auto; border-radius: 8px;
        text-align: left; font-size: 0.875rem; font-weight: 500; line-height: 1.5;
        background-color: var(--warn-bg); border: 1px solid var(--warn-border); color: var(--warn-text);
    }
    #projection-warning.critical { background-color: var(--critical-warn-bg); border-color: var(--critical-warn-border); color: var(--critical-warn-text); }
    
    .phase-header { font-size: 1rem; font-weight: 600; margin-top: 1.25rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid #e9ecef; }
    .indented-settings { margin-top: 1rem; margin-left: 1.25rem; padding-left: 1rem; border-left: 3px solid #e9ecef; }
    .projections-button-wrapper { display: flex; justify-content: center; align-items: center; gap: 1rem; margin-top: 1.5rem; }
    .projections-button-wrapper.loading { opacity: 0.7; cursor: not-allowed; }
    .debug-log {
      background-color: #2b2b2b; border: 1px solid #555; border-radius: 8px;
      margin: 1.25rem 0; padding: 1rem; font-family: monospace; font-size: 0.8125rem;
      color: #ccc; max-height: 250px; overflow-y: auto; white-space: pre-wrap;
      line-height: 1.6;
    }
    .debug-log h3 { margin-top: 0; color: #eee; border-bottom: 1px solid #555; padding-bottom: 0.5rem; }
    .debug-log p { margin: 0 0 0.3rem 0; }
    footer {
        text-align: center; font-size: 0.75rem; color: var(--text-light);
        margin: 2.5rem auto 1.25rem auto; padding: 1.25rem; max-width: 800px;
        border-top: 1px solid var(--border-color); line-height: 1.6;
    }
    .projection-model-tabs { display: flex; border-bottom: 1px solid var(--border-color); margin-bottom: 1.25rem; }
    .projection-tab {
        padding: 0.625rem 1.25rem; cursor: pointer; background-color: transparent; border: none;
        border-bottom: 3px solid transparent; font-size: 1rem; font-weight: 600; color: var(--text-light);
    }
    .projection-tab.active { color: var(--primary-color); border-bottom-color: var(--primary-color); }
    
    .checkbox-control { display: flex; align-items: center; gap: 0.5rem; margin-top: 0.625rem; }
    .checkbox-control input { width: auto; }
    .checkbox-control label { font-weight: normal; font-size: 0.875rem; margin: 0; }

    @media (max-width: 768px) {
      .app-container { padding: 0.3rem; } .section-card { padding: 1rem; }
      h1 { font-size: 1.5rem; } h2 { font-size: 1.25rem; }
      #setup-card .controls-grid { grid-template-columns: 1fr 1fr; gap: 0.75rem; }
      #retire-settings .controls-grid, #grow-settings .controls-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div id="master-tooltip"></div>
  <main class="app-container">
    <h1>Portfolio Backtester</h1>
    <p class="version">Version 8.1.0 (Refactored)</p>

<!-- Setup Section -->
<section id="setup-card" class="section-card">
  <h2>1. Backtest Setup</h2>
  <div class="controls-grid">
    <div class="control-group"><label for="start-date">Start Date <span class="help-icon" data-tooltip="The first day included in the historical test period. The actual start may be adjusted if an asset was created after this date.">?</span></label><input type="date" id="start-date" value="1990-01-02"></div>
    <div class="control-group"><label for="end-date">End Date <span class="help-icon" data-tooltip="The last day included in the historical test period.">?</span></label><input type="date" id="end-date"></div>
    <div class="control-group"><label for="initial-investment">Initial Investment ($) <span class="help-icon" data-tooltip="The starting amount of money in your portfolio on the Start Date.">?</span></label><input type="number" id="initial-investment" value="100000" min="0"></div>
    <div class="control-group"><label for="contribution-amount">Contribution Amount ($) <span class="help-icon" data-tooltip="The amount of new money you add to your portfolio at each interval.">?</span></label><input type="number" id="contribution-amount" value="400" min="0"></div>
    <div class="control-group"><label for="contribution-frequency">Contribution Frequency <span class="help-icon" data-tooltip="How often you add new money to your portfolio.">?</span></label><select id="contribution-frequency"><option value="weekly" selected>Weekly</option><option value="monthly">Monthly</option><option value="quarterly">Quarterly</option><option value="annually">Annually</option><option value="none">None</option></select></div>
    <div class="control-group"><label for="rebalance-frequency">Rebalance Frequency <span class="help-icon" data-tooltip="How often the portfolio is reset to its original target allocation. This involves selling winners and buying losers.">?</span></label><select id="rebalance-frequency"><option value="annually" selected>Annually</option><option value="quarterly">Quarterly</option><option value="never">Never</option></select></div>
    <div class="control-group"><label for="reinvest-dividends">Reinvest Dividends? <span class="help-icon" data-tooltip="Choose whether cash from dividends is automatically used to buy more shares or held as cash.">?</span></label><select id="reinvest-dividends"><option value="true" selected>True</option><option value="false">False</option></select></div>
    <div class="control-group"><label for="risk-free-rate">Risk-Free Rate (%) <span class="help-icon" data-tooltip="Used for Sharpe/Sortino ratios. This is treated as a constant value. The US 3-Month T-bill is the academic standard (e.g., ~4-5%). Defaulting to 0% is common for simplicity.">?</span></label><input type="number" id="risk-free-rate" value="0" min="0"></div>
    <div class="control-group"><label for="dividend-tax-rate">Dividend Tax Rate (%) <span class="help-icon" data-tooltip="The tax rate applied to dividends received. Set to 0 for tax-advantaged accounts like an IRA or 401(k).">?</span></label><input type="number" id="dividend-tax-rate" value="0" min="0"></div>
    <div class="control-group"><label for="gains-tax-rate">Capital Gains Tax (%) <span class="help-icon" data-tooltip="The tax rate applied to profits when assets are sold during rebalancing. Set to 0 for tax-advantaged accounts.">?</span></label><input type="number" id="gains-tax-rate" value="0" min="0"></div>
    <div class="control-group"><label for="benchmark1">Benchmark 1 <span class="help-icon" data-tooltip="A market index (like SPY for the S&P 500) to compare your portfolio's performance against. This is also used as the proxy for synthetic history generation.">?</span></label><input type="text" id="benchmark1" value="SPY"></div>
    <div class="control-group"><label for="benchmark2">Benchmark 2 <span class="help-icon" data-tooltip="A second market index to include for comparison.">?</span></label><input type="text" id="benchmark2" value="QQQ"></div>
  </div>
  <div class="checkbox-control" style="margin-top: 1rem;">
      <input type="checkbox" id="use-synthetic-history" checked>
      <label for="use-synthetic-history">Use Synthetic History for newer funds</label>
      <span class="help-icon" data-tooltip="For funds created after the Start Date, this will simulate their past performance based on their behavior relative to the Benchmark 1 proxy. This allows for longer, more meaningful backtests.">?</span>
  </div>
</section>

<!-- Portfolio Configuration Section -->
<section id="portfolio-config-card" class="section-card">
  <h2>2. Configure Portfolios</h2>
  <div id="portfolios-container"></div>
  <div id="portfolios-empty-state" class="hidden">
      No portfolios configured. Click <strong>+ Add Portfolio</strong> to get started!
  </div>
  <button id="add-portfolio-btn" class="add-btn">+ Add Portfolio</button>
</section>

<div id="run-button-container-id" class="run-button-container">
    <button id="run-backtest-btn" class="add-btn">Run Backtest</button>
    <div id="loader" class="loader"></div>
</div>
<div id="error-container" aria-live="polite"></div>
<div id="info-container" aria-live="polite"></div>
<div id="backtest-debug-container" class="debug-log hidden"><h3>Backtest Debug Log:</h3></div>

<!-- Results Dashboard -->
<div id="results-area" class="section-card hidden basic-view">
  <div class="results-header">
      <h2>3. Backtest Results</h2>
      <div class="toggle-switch">
          <label for="results-view-toggle">Basic</label>
          <input type="checkbox" id="results-view-toggle">
          <label for="results-view-toggle">Advanced</label>
      </div>
  </div>
  <section id="performance-chart-card" class="hidden"><canvas id="backtest-chart" style="margin-top:1.5rem;"></canvas></section>
  <section><h3>Capital Snapshot</h3><div id="snapshot-table-container" class="table-container"></div></section>
  <section><h3>Asset Allocation</h3><div id="allocation-table-container" class="table-container"></div></section>
  <section><h3>Income & Yield</h3><div id="income-table-container" class="table-container"></div></section>
  <section class="advanced-metric-card"><h3>Costs & Efficiency</h3><div id="costs-table-container" class="table-container"></div></section>
  <section class="advanced-metric-card"><h3>Risk & Volatility</h3><div id="risk-table-container" class="table-container"></div></section>
  <section class="advanced-metric-card"><h3>Drawdowns</h3><div id="drawdown-table-container" class="table-container"></div></section>
  <section class="advanced-metric-card"><h3>Consistency</h3><div id="consistency-table-container" class="table-container"></div></section>
  <section>
    <h3>Holdings Breakdown</h3>
    <div id="holdings-tables-container"></div>
  </section>
</div>

<!-- Future Projections Section -->
<section id="projections-area" class="section-card hidden">
    <h2>4. Future Projections</h2>
    <div id="projection-warning" class="hidden"></div>
    <div class="control-group" style="margin-bottom: 1.25rem;">
        <label for="projection-goal">What is your goal? <span class="help-icon" data-tooltip="Choose a goal. Projections use the historical return and volatility from the backtest as the baseline for the simulation.">?</span></label>
        <select id="projection-goal">
            <option value="grow" selected>Continue saving and grow my portfolio</option>
            <option value="retire">Plan for a future retirement income</option>
        </select>
    </div>

    <div class="controls-grid" style="grid-template-columns: 1fr 1fr; margin-bottom: 1.25rem;">
        <div class="control-group">
            <label for="projection-start-value">Projection Starting Value ($) <span class="help-icon" data-tooltip="The starting balance for the future projection. This defaults to the ending balance from your first portfolio's backtest, but you can override it to model a different scenario.">?</span></label>
            <input type="number" id="projection-start-value" value="0" min="0">
        </div>
        <div class="control-group">
            <label for="sim-quality">Simulation Quality <span class="help-icon" data-tooltip="The number of possible future scenarios we will test. 'Recommended' offers a good balance of speed and accuracy.">?</span></label>
            <select id="sim-quality">
                <option value="1000">Fast</option>
                <option value="5000" selected>Recommended</option>
                <option value="10000">High Precision</option>
            </select>
        </div>
    </div>
    
    <div id="grow-settings">
        <div class="controls-grid">
            <div class="control-group"><label for="grow-projection-period">Projection Period (Years) <span class="help-icon" data-tooltip="How many years into the future you want to simulate (1–100).">?</span></label><input type="number" id="grow-projection-period" value="10" min="1" max="100"></div>
            <div class="control-group"><label for="grow-inflation-rate">Assumed Annual Inflation (%) <span class="help-icon" data-tooltip="Used to show results in ‘today’s dollars.’ Leave 0% for nominal results.">?</span></label><input type="number" id="grow-inflation-rate" value="0" min="0"></div>
            <div class="control-group"><label for="grow-contribution-increase">Annual Contribution Increase (%) <span class="help-icon" data-tooltip="If your savings grow each year, add a percent here; leave 0% to keep deposits flat.">?</span></label><input type="number" id="grow-contribution-increase" value="0" min="0"></div>
        </div>
    </div>
    <div id="retire-settings" class="hidden">
        <div class="control-group" style="margin-bottom: 1.25rem;"><label for="current-age">What is your current age? <span class="help-icon" data-tooltip="Your current age. This is used as the starting point for retirement projections.">?</span></label><input type="number" id="current-age" value="20" min="0"></div>
        <div class="phase-header">Phase 1: Your Working Years (Saving)</div>
        <div class="controls-grid">
             <div class="control-group"><label for="retirement-age">At what age do you want to retire? <span class="help-icon" data-tooltip="The age you plan to stop working and start drawing an income from your portfolio.">?</span></label><input type="number" id="retirement-age" value="65" min="0"></div>
             <div class="control-group"><label for="retire-contribution-increase">Annual Saving Increase (%) <span class="help-icon" data-tooltip="If your savings grow each year, add a percent here; leave 0% to keep deposits flat.">?</span></label><input type="number" id="retire-contribution-increase" value="0" min="0"></div>
        </div>
        <div class="phase-header">Phase 2: Your Retirement Years (Income)</div>
        <div class="controls-grid">
            <div class="control-group">
                <label for="withdrawal-strategy">Retirement income plan? <span class="help-icon" data-tooltip="Choose how you want to receive your income in retirement. This determines how money is withdrawn from your portfolio.">?</span></label>
                <select id="withdrawal-strategy">
                    <option value="dividends">Live Off Dividend Income Only</option>
                    <option value="fixed_amount" selected>Withdraw a Fixed Amount Annually</option>
                    <option value="percentage">Withdraw a Percentage Annually</option>
                </select>
            </div>
            <div class="control-group"><label for="final-age">How long should income last? <span class="help-icon" data-tooltip="The age until which you need your retirement income to last.">?</span></label><input type="number" id="final-age" value="95" min="0"></div>
        </div>
        <div class="indented-settings">
            <div class="control-group hidden" id="fixed_amount_setting"><label for="annual-withdrawal-amount">Annual Withdrawal Amount ($) <span class="help-icon" data-tooltip="The amount of money you plan to withdraw each year for living expenses in retirement.">?</span></label><input type="number" id="annual-withdrawal-amount" value="50000" min="0"></div>
            <div class="control-group hidden" id="percentage_setting"><label for="annual-withdrawal-rate">Annual Withdrawal Rate (%) <span class="help-icon" data-tooltip="Typical rule-of-thumb is 4%. Higher % = higher risk of running out of money.">?</span></label><input type="number" id="annual-withdrawal-rate" value="4" min="0"></div>
        </div>
         <div class="control-group" style="margin-top:1.25rem;">
            <label for="retire-inflation-rate">Assumed Annual Inflation (%) <span class="help-icon" data-tooltip="Used to show results in ‘today’s dollars.’ Leave 0% for nominal results.">?</span></label><input type="number" id="retire-inflation-rate" value="0" min="0">
        </div>
    </div>
    <div class="control-group">
        <div class="checkbox-control">
            <input type="checkbox" id="apply-cap-checkbox" checked>
            <label for="apply-cap-checkbox">Apply Realistic Return Cap (12%)</label>
            <span class="help-icon" data-tooltip="When checked, any historical return above 12% is capped at 12% for the projection. This helps ground very optimistic backtests in a more conservative long-term reality. Uncheck for a purely theoretical extrapolation.">?</span>
        </div>
    </div>
    <div id="projections-button-wrapper-id" class="projections-button-wrapper">
        <button id="run-projections-btn" class="add-btn">Run Projections</button>
        <div id="projections-loader" class="loader"></div>
    </div>
    <div id="projection-debug-container" class="debug-log hidden"><h3>Projection Debug Log:</h3></div>
    
    <div id="projections-results-tabs-container" class="hidden" style="margin-top: 1.25rem;">
        <div class="projection-model-tabs">
            <button id="simple-tab-btn" class="projection-tab" data-tooltip="Shows a simple, year-by-year forecast assuming the historical return repeats exactly every year. Does not account for market volatility.">Simple Projection</button>
            <button id="mc-tab-btn" class="projection-tab active" data-tooltip="Simulates thousands of possible futures based on the historical return AND volatility, showing a range of potential outcomes.">Monte Carlo Simulation</button>
        </div>
        <div id="simple-projection-content" class="hidden"></div>
        <div id="mc-projection-content">
            <div id="projections-results-area"></div>
            <div id="projection-chart-container" class="hidden"><div style="width: 100%; max-width: 900px; margin: auto; padding-bottom: 1.25rem;"><canvas id="projection-chart"></canvas></div></div>
        </div>
    </div>
</section>
<footer>
    <p><strong>Disclaimer:</strong> This tool is for informational and illustrative purposes only. The results are based on historical data and Monte Carlo simulations, which are not guarantees of future performance. Past performance is not indicative of future results. All investments involve risk and may lose value.</p>
    <p>Market data is fetched via public CORS proxies and may be delayed or unavailable at times. Do not base real-world financial decisions solely on this tool.</p>
</footer>
  </main>
  <!-- SCRIPT IS NOW IN A SEPARATE FILE -->
  <script src="app.js" defer></script>
</body>
</html>
